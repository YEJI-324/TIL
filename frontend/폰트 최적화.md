# 폰트 최적화

Date: April 11, 2023
Tags: 최적화
Type: Frontend

텍스트가 보이는 시점에 폰트 다룬로드가 완료되지 않아 생기는 현상.

페이지가 로드되고 폰트 다운로드가 완료되면 폰트가 제대로 적용됨.

: 사용성에 영향을 줌. 폰트가 바뀌면서 깜박이는 모습은 페이지가 느리다는 느낌. + 다른 요소를 밀어낼 수도 있음.

→ 폰트 관련 문제를 해결하는 방법을 알아봅쉬당!

## FOUT, FOIT

- FOUT : Flash of Unstyled Text
    - Edge 브라우저에서 폰트를 로드하는 방식
    - 폰트의 다운로드 여부와 상관없이 먼저 텍스트를 보여준 후 폰트가 다운로드되면 그때 폰트를 적용하는 방식
- FOIT : Flash of Invisible Text
    - 크롬, 사파리, 파이어폭스 등에서 폰트를 로드하는 방식
    - 폰트가 완전히 다운로드되기 전까지 텍스트 자체를 보여주지 않음.
    - 폰트 다운로드가 완료되면 폰트가 적용된 텍스트를 보여줌.
    - 3초동안 기다리고 다운로드 되지 않으면 기본 폰트로 텍스트를 보여줌.  → 폰트 다운로드되면 해당 폰트 적용

## 폰트 최적화 방법

1. 폰트 적용 시점을 제어하는 방법
2. 폰트 사이즈를 줄이는 방법

### 폰트 적용 시점 제어하기

- FOUT : 사용자에게 꼭 전달하지 않아도 되는 텍스트일 때 FOUT 방식으로 폰트 변화는 사용자의 시선을 분산시킬 수 있음.
- FOIT : 텍스트 내용이 사용자에게 빠르게 전달되지않음

⇒ 서비스 또는 콘텐츠의 속성에 맞게 적잘한 방식을 적용해야함.

CSS 의 font-display 속성을 이용하면 폰트가 적용되는 시점을 제어할 수 있음. font-display는 @fount-face에서 설정할 수 있음.

******속성******

- auto : 브라우저 기본 동작
- block : FOIT (timeout = 3s)
- swap : FOUT
- fallback : FOIT (timeout = 0.1s) / 3초 후에도 불러오지 못한 경우 기본 폰트로 유지, 이후 캐시
- optional : FOIT (timeout = 0.1s) / 이후 네트워크 상태에 따라 기본 폰트로 유지할지 결정, 이후 캐시

fallback, optional은 텍스트를 안보여주는 시간이 3초가 아닌 0.1초임.

- fallback : 3초 후에도 폰트를 다운로드하지 못한 경우, 이후 폰트가 다운로드되더라도 폰트를 적용하지 않고 캐시해둠. → 다시 로드했을 때 캐시된 폰트가 적용됨.
- optional : 3초가 아니라 사용자의 네트워크 상태를 기준으로 폰트를 적용할지 기본 폰트로 유지할지 결정함.
    
    font-display 속성을 이용해 폰트가 적용되는 시점을 제어할 수 있음.
    

### 폰트 파일 크기 줄이기

폰트 파일 크기를 줄여 폰트가 다운로드되는 시간을 단축하는 방법.

1. 압축률이 좋은 폰트 포맷을 사용하는 방법
2. 필요한 문자의 폰트만 로드하는 방법

********************************************폰트 포맷 변경하기********************************************

TTF/OFT 포맷 : 

TTF : 파일 크기가 매우 큼

→ WOFF(Web Open Font Format) 등장 : 웹을 위한 폰트

→ WOFF2라는 더욱 향상된 압축 방식을 적용한 포맷

하지만 WOFF, WOFF2는 브라우저 호환성 문제가 있음. 

→ WOFF2 > WOFF > TTF/OFT > EOT 순으로 폰트 적용하도록 구현

**서브셋 폰트 사용**

모든 문자가 아닌 일부 문자의 폰트 정보만 가지고 있는 것을 서브셋 폰트라고 함.

→ 폰트를 파일 형태가 아닌 Data-URI 형태로 CSS 파일에 포함할 수 있음. 

Data-URI란 data 스킴이 접두어로 붙은 문자열 형태의 데이터, 쉽게 말해 파일을 문자열 형태로 변화해 문서에 인라인으로 삽입하는 것. 보통 App.css 파일에 넣어서 폰트 사용.

주의할 점은 Data-URI 형태가 항상 좋은 것은 아님. App.css 다운로드 속도를 고려해야함. 폰트 파일 크기가 크면 Data-URI 형태로 포함해도 Data-URI을 포함한 파일 크기가 그만큼 커져서 또 다른 병목 발생시킬 수 있음.
